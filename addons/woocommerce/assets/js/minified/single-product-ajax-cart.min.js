(d=>{null!=window.astra&&(astraSingleProductAjax={quick_view_enable:astra.shop_quick_view_enable||!1,ajax_add_to_cart_enable:astra.single_product_ajax_add_to_cart||!1,init:function(){this._bind()},_bind:function(){astraSingleProductAjax.ajax_add_to_cart_enable&&d(document).on("click","body.single-product .product:not(.product-type-external) button.single_add_to_cart_button, #sticky-add-to-cart .single_add_to_cart_button",astraSingleProductAjax._processAjaxRequest),astraSingleProductAjax.quick_view_enable&&d(document.body).on("click","#ast-quick-view-content .product:not(.product-type-external) button.single_add_to_cart_button",astraSingleProductAjax._processAjaxRequest),d(document.body).on("added_to_cart",astraSingleProductAjax._updateButton),d("form.variations_form").on("woocommerce_variation_has_changed",astraSingleProductAjax._updateSaleBadge)},_processAjaxRequest:function(a){a.preventDefault();a=d(this).closest("form");if(!a[0].checkValidity())return a[0].reportValidity(),!1;var t=d(this),r=d(this).val()||"";d('input[name="variation_id"]').val();if(!t.hasClass("disabled")){t.removeClass("added"),t.addClass("loading");d('input[name="quantity"]').val();d(".woocommerce-grouped-product-list-item").length&&(o=d("input.qty"),d.each(o,function(a,t){var e=d(this).attr("name");e=(e=e.replace("quantity[","")).replace("]",""),e=parseInt(e),d(this).val()&&(e,d(this).val())}));var o=a.serialize(),a=new URLSearchParams(window.location.search),a=Object.fromEntries(a.entries());let e=new URLSearchParams(o);r=r||e.get("product_id"),Object.entries(a).forEach(([a,t])=>e.set(a,t)),e.set("action","astra_add_cart_single_product"),e.set("add-to-cart",r),d.ajax({url:astra.ajax_url+"?"+e.toString(),type:"GET",success:function(a){if(0===a.length)return location.reload(),!1;d(document.body).trigger("wc_fragment_refresh"),d(document.body).trigger("added_to_cart",[a.fragments,a.cart_hash,t]),astra.is_single_product&&(a=d("#astra-mobile-cart-drawer"),"slide_in_cart"===astra.add_to_cart_options_single&&a&&(a.addClass("active"),d("html").addClass("ast-mobile-cart-active")),"redirect_cart_page"===astra.add_to_cart_options_single&&window.open(astra.cart_url,"_self"),"redirect_checkout_page"===astra.add_to_cart_options_single&&window.open(astra.checkout_url,"_self"),"default"===astra.add_to_cart_options_single)&&"undefined"!=typeof wc_add_to_cart_params&&"yes"===wc_add_to_cart_params.cart_redirect_after_add&&(window.location=wc_add_to_cart_params.cart_url)}})}},_updateButton:function(a,t,e,r){r=void 0!==r&&r,d("button.single_add_to_cart_button").length&&(d(r).removeClass("loading"),d(r).addClass("added"),astra.is_cart||0!==d(r).parent().find(".added_to_cart").length||d(r).after(' <a href="'+astra.cart_url+'" class="added_to_cart wc-forward" title="'+astra.view_cart+'">'+astra.view_cart+"</a>"),d(document.body).trigger("wc_cart_button_updated",[r]))},_updateSaleBadge:function(a){var t,e,r=d(this),o=r.find(".variation_id").val();""!=o&&"sale-percentage"==(r=r.closest(".product-type-variable").find("span.onsale")).data("notification")&&void 0!==(t=r.data("sale"))[o]&&(e=(e=r.data("sale-per-text")).replace("[value]",t[o]),r.text(e))}},d(function(){astraSingleProductAjax.init()}))})(jQuery);